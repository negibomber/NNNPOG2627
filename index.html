<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>NNNPOG 2026-27</title>
    <link rel="stylesheet" href="/static/css/style.css">
    <style>
        /* CSSãŒç©ºã®çŠ¶æ…‹ã§ã‚‚æœ€ä½é™å‹•ããŸã‚ã®æš«å®šãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆï¼ˆå¾Œã»ã©style.cssã¸ç§»è¡Œï¼‰ */
        :root { --primary: #2563eb; --bg: #f8fafc; }
        body { font-family: sans-serif; background: var(--bg); margin: 0; padding-bottom: 100px; }
        header { background: #1e293b; color: white; padding: 15px; position: sticky; top: 0; z-index: 100; }
        .tabs { display: flex; background: white; border-bottom: 1px solid #ddd; }
        .tab-btn { flex: 1; padding: 15px; border: none; background: none; font-weight: bold; cursor: pointer; }
        .tab-btn.active { border-bottom: 3px solid var(--primary); color: var(--primary); }
        .container { padding: 15px; }
        .tab-content { display: none; }
        .tab-content.active { display: block; }
        .card { background: white; padding: 15px; border-radius: 10px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); margin-bottom: 15px; }
        input { width: 100%; padding: 12px; margin-bottom: 10px; border: 1px solid #ccc; border-radius: 5px; box-sizing: border-box; }
        button.main-btn { width: 100%; padding: 15px; background: var(--primary); color: white; border: none; border-radius: 5px; font-weight: bold; }
        .mc-panel { position: fixed; bottom: 0; width: 100%; background: #1e293b; color: white; padding: 15px; box-sizing: border-box; }
        .mc-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; }
        #reveal_area { background: #fffbeb; border: 2px solid #f59e0b; padding: 15px; border-radius: 10px; margin-bottom: 15px; display: none; text-align: center; }
        @media (min-width: 768px) {
            .tabs { display: none; }
            .content-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; }
            .tab-content { display: block !important; }
        }
    </style>
</head>
<body>

<header>
    <div style="display:flex; justify-content:space-between;">
        <strong>ç¬¬ <span id="round_display">{{ current_round }}</span> å·¡</strong>
        <span id="phase_display">èª­ã¿è¾¼ã¿ä¸­...</span>
    </div>
    <div style="font-size: 0.8rem; margin-top: 5px;">User: {{ user }}</div>
</header>

<div class="tabs">
    <button class="tab-btn active" onclick="switchTab('tab-search')">æŒ‡å</button>
    <button class="tab-btn" onclick="switchTab('tab-my')">ãƒã‚¤ãƒªã‚¹ãƒˆ</button>
    <button class="tab-btn" onclick="switchTab('tab-all')">å…¨ä½“</button>
</div>

<div class="container">
    <div id="reveal_area">
        <div style="font-weight:bold; color:#b45309;">å…¬é–‹ä¸­...</div>
        <div id="reveal_player" style="font-size:1.2rem; margin:10px 0;"></div>
        <div id="reveal_horse" style="font-size:1.5rem; font-weight:bold;"></div>
        <div style="font-size:0.9rem; margin-top:5px;">
            çˆ¶: <span id="reveal_father"></span> / æ¯: <span id="reveal_mother"></span>
        </div>
    </div>

    <div class="content-grid">
        <div id="tab-search" class="tab-content active">
            <div class="card">
                <h3>é¦¬ã‚’æ¢ã™</h3>
                <input type="text" id="s_father" placeholder="çˆ¶å (2æ–‡å­—ä»¥ä¸Š)">
                <input type="text" id="s_mother" placeholder="æ¯å (2æ–‡å­—ä»¥ä¸Š)">
                <button class="main-btn" onclick="searchHorses()">æ¤œç´¢</button>
                <div id="search_results" style="margin-top:20px;"></div>
            </div>
        </div>

        <div id="tab-my" class="tab-content">
            <div class="card">
                <h3>ã‚¨ãƒ³ãƒˆãƒªãƒ¼ä¸­ã®é¦¬</h3>
                <div id="current_nomination_status" style="font-size:1.2rem; font-weight:bold; color:var(--primary);">
                    {% if current_horse %}{{ current_horse }}{% else %}æœªæŒ‡å{% endif %}
                </div>
                {% if won_horse %}
                <div style="margin-top:10px; color:green;">ğŸ‰ å½“é¸ç¢ºå®š: {{ won_horse }}</div>
                {% endif %}
            </div>
            <div class="card">
                <h3>ç²å¾—æ¸ˆã¿</h3>
                <div id="my_list">
                    {% for h in confirmed_horses %}
                        {% if h.player_name == user %}
                        <div>ç¬¬{{ h.round }}å·¡: {{ h.horse_name }}</div>
                        {% endif %}
                    {% endfor %}
                </div>
            </div>
        </div>

        <div id="tab-all" class="tab-content">
            <div class="card">
                <h3>æŒ‡åçŠ¶æ³</h3>
                <div id="all_status"></div>
            </div>
        </div>
    </div>
</div>

{% if is_mc %}
<div class="mc-panel">
    <div style="font-size:0.7rem; text-align:center; margin-bottom:10px;">MC CONTROL</div>
    <div class="mc-grid">
        <button onclick="startReveal()" style="background:#3b82f6; color:white; border:none; padding:10px; border-radius:5px;">å…¬é–‹é–‹å§‹</button>
        <button onclick="nextReveal()" style="background:#f59e0b; color:white; border:none; padding:10px; border-radius:5px;">æ¬¡ã®äººã¸</button>
        <button onclick="runLottery()" style="background:#ef4444; color:white; border:none; padding:10px; border-radius:5px;">æŠ½é¸å®Ÿè¡Œ</button>
        <button onclick="nextRound()" style="background:#10b981; color:white; border:none; padding:10px; border-radius:5px;">æ¬¡ãƒ©ã‚¦ãƒ³ãƒ‰</button>
    </div>
</div>
{% endif %}

<script src="/static/js/app.js"></script>
</body>
</html>